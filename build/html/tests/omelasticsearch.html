
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>rsyslog omelasticsearch bechmark report &mdash; ELMA 0.2.9 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.2.0/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/my-styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="ELMA 0.2.9 documentation" href="../index.html" />
    <link rel="up" title="Performance and compression tests" href="index.html" />
    <link rel="next" title="Frequently Asked Questions" href="../faq/index.html" />
    <link rel="prev" title="rsyslog omfile bechmark report" href="omfile.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/logo_elma.png" alt="Logo" class="img-thumbnail navbar-logo">
          ELMA documentation</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="http://enterprise-log-management-appliance.org/">Project Home</a></li>
                <li><a href="../genindex.html">Index</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Main Topics <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about.html#ingredients">Ingredients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html#cookbook">Cookbook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html#menue">Menue</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#details">Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about.html#syslog-evolution">Syslog evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html#next-generation-databases">Next generation databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html#common-event-expression-cee-enhanced-syslog">Common Event Expression - CEE enhanced syslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html#our-goal">Our goal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html#why-not-just-archive-everything-in-elasticsearch">Why not just archive everything in ElasticSearch?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html#why-elma">Why ELMA?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html#howto-integrate-into-your-existing-logging-and-monitoring-infrasructure">Howto integrate into your existing logging and monitoring infrasructure?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../2do.html">2do</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../2do.html#issues">Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2do.html#problems">Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2do.html#feature-requests">Feature requests</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manuals/index.html">Manuals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../manuals/requirements.html">Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/requirements.html#basic-knowledge">Basic Knowledge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/requirements.html#system-and-hardware-requirements">System and Hardware Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manuals/virtualization.html">Virtualization Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/virtualization.html#virtual-formats">Virtual formats</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manuals/loadbalancing.html">Loadbalancing and redundancy Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/loadbalancing.html#distributed-elasticsearch-cluster">Distributed elasticsearch cluster</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manuals/installation/index.html">Installation Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/installation/time.html">Hardware (CMOS/BIOS) Clock and System Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/installation/firstboot.html">First Boot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/installation/index.html#elma-initial-installation">ELMA initial installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/installation/index.html#reset-elma-configuration-parameter-to-factory-defaults">Reset ELMA configuration parameter to factory defaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/installation/index.html#next-installation-steps">Next installation steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manuals/update.html">Patch, Update and Upgrade Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/update.html#requirements-and-recommendations">Requirements and recommendations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/update.html#patches">Patches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/update.html#updates">Updates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/update.html#upgrades">Upgrades</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/update.html#reconfigure-elma">Reconfigure ELMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/update.html#final-tests">Final Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/update.html#reset-elma-configuration-parameter-to-factory-defaults">Reset ELMA configuration parameter to factory defaults</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manuals/configuration/index.html">Configuration Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/configurationfiles.html">Configuration Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/index.html#elma">ELMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/index.html#snmptrap">snmptrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/index.html#rsyslog">rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/index.html#logstash">logstash</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/index.html#elasticsearch">ElasticSearch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/index.html#apache2">Apache2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/index.html#nagios">Nagios</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/configuration/index.html#kibana">Kibana</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manuals/administration.html">Administration Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/administration.html#basic-knowledge">Basic Knowledge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/administration.html#supported-web-browsers">Supported web browsers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/administration.html#elma-admin-interfaces">ELMA admin interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/administration.html#elma-user-management">ELMA user management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/administration.html#elma-group-and-profile-management">ELMA group and profile management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manuals/operation.html">Operation Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/operation.html#basic-knowledge">Basic Knowledge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/operation.html#secure-network-operations">Secure Network Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/operation.html#event-and-trap-generation-for-specific-testing">Event and trap generation for specific testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/operation.html#basic-operations">Basic operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manuals/user.html">User Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manuals/user.html#supported-web-browsers">Supported web browsers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manuals/user.html#elma-user-interfaces">ELMA user interfaces</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Performance and compression tests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#generation-of-continious-tcp-logging">Generation of continious tcp logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#rsyslog-output-modules">rsyslog output modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#omfile-file-output-module">omfile - File Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#omelasticsearch-elasticsearch-output-module">omelasticsearch - ElasticSearch Output Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#comparison">Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#log-space-sizing">Log space sizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#testbed">Testbed</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#which-web-browsers-are-supported">Which web browsers are supported?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#file-system-sizing-immediately-after-deployment">File System Sizing immediately after deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#increase-disk-space-using-the-yast-partitioner">Increase disk space using the YAST partitioner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-do-i-limit-how-much-storage-space-is-used">How do I limit how much storage space is used?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#apache-failing-to-start-after-patching-and-upgrading">Apache failing to start after patching and upgrading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#warning-patch-opensuse-2014-493-1-is-interactive-skipping">Warning: Patch &#8216;openSUSE-2014-493-1&#8217; is interactive, skipping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#searchphaseexecutionexception-failed-to-execute-phase-query-fetch">SearchPhaseExecutionException - Failed to execute phase query_fetch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#elasticsearchexception-java-lang-outofmemoryerror-java-heap-space">ElasticsearchException - java.lang.OutOfMemoryError: Java heap space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#are-older-opensuse-12-x-appliances-being-supported-in-future">Are older openSUSE 12.x appliances being supported in future?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#howto-upgrade-elma-appliance-to-opensuse-13-1">Howto upgrade ELMA appliance to openSUSE 13.1?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-to-forward-syslog-events-from-syslog-ng-to-elma-rsyslogd">How to forward syslog events from syslog-ng to ELMA rsyslogd?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-to-forward-syslog-events-from-rsyslogd-to-elma-rsyslogd">How to forward syslog events from rsyslogd to ELMA rsyslogd?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-to-enable-compressed-event-forwarding-between-rsyslogd-servers">How to enable compressed event forwarding between rsyslogd servers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#how-to-resolve-original-syslog-sender-ip-to-sender-hostname">How to resolve original syslog sender IP to sender hostname?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#wrong-timpstamp-in-elma-search-gui-is-your-system-time-synchronized-and-up-to-date">Wrong timpstamp in ELMA Search-Gui - Is your system time synchronized and up to date?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#no-events-in-elma-search-gui-till-utc-xxx-have-you-set-system-clock-to-utc">No events in ELMA Search-Gui till UTC+XXX - Have you set system clock to UTC?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#coordinated-universal-time">Coordinated Universal Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#system-time">System time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#rsyslog-timestamp-formatting-timestamp-parsing-problems">Rsyslog timestamp formatting - Timestamp parsing problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/index.html#unresolvedaddressexception-have-you-setup-a-static-ip-address">UnresolvedAddressException - Have you setup a static IP address?</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../whitepapers/index.html">Whitepapers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../whitepapers/index.html#regulatory-frameworks">Regulatory frameworks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../whitepapers/index.html#german-publications">German publications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/git.html">git</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/git.html#git-repository">git repository</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/curl.html">curl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/curl.html#curl-exit-codes">curl exit codes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/nagios.html">Nagios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/nagios.html#nagios-plugins">Nagios plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/webdesign.html">Webdesign</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/webdesign.html#bootstrap">bootstrap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/nomachinenx.html">NoMachineNX</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/nomachinenx.html#installation-on-opensuse">Installation on openSUSE</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="omfile.html" title="Previous Chapter: rsyslog omfile bechmark report"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; rsyslog omfile b...</span>
    </a>
  </li>
  <li>
    <a href="../faq/index.html" title="Next Chapter: Frequently Asked Questions"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Frequently Asked... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><div id="sourcelink">
  <h3>Table Of Contents</h3>
  <ul>
<li><a class="reference internal" href="#">rsyslog omelasticsearch bechmark report</a></li>
</ul>

</div>
  <div id="sourcelink">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tests/omelasticsearch.txt"
        rel="nofollow">Show Source</a></li>
        <li><a href="https://github.com/enterprise-log-management-appliance/elma-doc/edit/master/source/tests/omelasticsearch.rst"
          rel="nofollow">Edit Source on GitHub</a></li>
    </ul>
  </div>
        </div>
      </div>
    <div class="col-md-9">
      <h1><a href="http://enterprise-log-management-appliance.org/" target="_blank"><img alt="Banner" src="../_static/banner_elma.png" ></a></h1>
      &nbsp;
      
  <div class="section" id="rsyslog-omelasticsearch-bechmark-report">
<h1>rsyslog omelasticsearch bechmark report<a class="headerlink" href="#rsyslog-omelasticsearch-bechmark-report" title="Permalink to this headline">Â¶</a></h1>
<div class="highlight-python"><pre>/usr/share/elma-tests/bin/elma_elasticsearch_compression_rate.sh
===========================================================================================
Scriptname : elma_elasticsearch_compression_rate.sh
-------------------------------------------------------------------------------------------
Description: rsyslogd performance and elasticsearch compression test
Author     : Joerg Heinemann
Website    : http://enterprise-log-management-appliance.org
===========================================================================================
--- without compression
===========================================================================================
--- 23:47:38.195 - init -------------------------------------------------------------------
--- 23:47:38.228 - delete elasticsearch diag index ----------------------------------------
{"ok":true,"acknowledged":true}
--- 23:47:38.581 - start rsyslogd ---------------------------------------------------------
# author: Joerg Heinemann
# website: http://enterprise-log-management-appliance.org
# license: GPL v3
#
# /opt/elma/config/rsyslog.d/elma_imptcp_elasticsearch-no-compression.conf
#
# simple async writing test to elasticsearch
# Joerg Heinemann, 2012-12-31
$IncludeConfig /opt/elma/config/rsyslog.d/diag-common.conf
$MaxMessageSize 10k
$ModLoad imptcp
$MainMsgQueueTimeoutShutdown 10000
$InputPTCPServerRun 13514
# ######### Enable In-Memory queues ##########
#
# An in-memory queue is created for this action. If the remote host or
# database is down, messages are spooled to memory and sent when it is
# up again.
#
# The advantages are that it will be consistently good in terms of performance
# and it will fail fast.
#
# The downside is that you can keep a limited number of messages in that queue,
# less than you normally can with a disk-assisted queue.
#
# allocate memory dynamically for the queue. Better for handling spikes
$MainMsgQueueType LinkedList
# how many messages (messages, not bytes!) to hold in memory
$MainMsgQueueSize 8000000
# don't throttle receiving messages when the queue gets full
$MainMsgQueueTimeoutEnqueue 0
# ######### Event forwarding to ElasticSearch ##########
#
# Enable ElasticSearch output
#
$ModLoad omelasticsearch.so
# Template for JSON output
#
#$template ls_json,"{\"@timestamp\":\"%timereported:1:19:date-rfc3339%.%timereported:1:3:date-subseconds%\",\"@source_host\":%source:::jsonf%\",\"@source\":\"syslog://%fromhost-ip:::json%\",\"@message\":\"%timereported% %app-name%:%msg:::json%\",\"@fields\":{%syslogfacility:facility%,%syslogfacility-text:facility_label%,%syslogseverity:severity%,%syslogseverity-text:severity_label%,%pri:priority%,%app-name:program%,%procid:processid%},\"@customer\":\"AIDB\"}"
$template ls_json,"{%timestamp:::date-rfc3339,jsonf:@timestamp%,%source:::jsonf:@source_host%,\"@source\":\"syslog://%fromhost-ip:::json%\",\"@message\":\"%timestamp% %app-name%:%msg:::json%\",\"@fields\":{%syslogfacility:::jsonf:facility%,%syslogfacility-text:::jsonf:facility_label%,%syslogseverity:::jsonf:severity%,%syslogseverity-text:::jsonf:severity_label%,%pri:::jsonf:priority%,%app-name:::jsonf:program%,%procid:::jsonf:processid%},\"@customer\":\"AIDB\",\"@type\":\"events\"}"
$template srchidx,"diag-no-compression"
# now we put everything together
# "template" is for storing the syslog fields we want
#
local4.* action(type="omelasticsearch"
                template="ls_json"
                searchIndex="srchidx"
                dynSearchIndex="on"
                asyncrepl="on"
                searchType="events"
                server="localhost"
                serverport="9200"
#                uid="elma"
#                pwd="fjg892345sdfsdwf43d"
                bulkmode="on"
                queue.dequeuebatchsize="65536"
                queue.type="linkedlist"
                queue.filename="dbq"
                queue.highwatermark="500000"
                queue.lowwatermark="400000"
                queue.discardmark="5000000"
                queue.timeoutenqueue="0"
                queue.maxdiskspace="5g"
                queue.size="2000000"
                queue.saveonshutdown="on"
                action.resumeretrycount="-1")
# There are some other nice things you can use:
#
#    searchIndex               - for letting rsyslog know where to get these names
#    dynSearchIndex="on"       - for having variable index names
#    searchType="mycustomtype" - to specify a different type than "events".
#                                You can have dynSearchType="on" to have it variable, like you can with indices.
#    serverport="9200"         - the default setting, but you can specify a different port
#    asyncrepl="on"            - to enable asyncronous replication.
#                                That is, Elasticsearch gives an answer imediately
#                                after inserting to the main shard(s).
#                                It doesn't wait for replicas to be updated as well, which is the default setting
#    timeout="1m"              - how long to wait for a reply from Elasticsearch.
#                                More info here, near the end:
#                                http://www.elasticsearch.org/guide/reference/api/index_.html
# /opt/elma/config/rsyslog.d/diag-common.conf
#
# This is a config include file. It sets up rsyslog so that the
# diag system can successfully be used. Also, it generates a file
# "rsyslogd.started" after rsyslogd is initialized. This config file
# should be included in all tests that intend to use common code for
# controlling the daemon.
# NOTE: we assume that rsyslogd's current working directory is
# ./tests (or the distcheck equivalent), in particlular that this
# config file resides in the testsuites subdirectory.
# rgerhards, 2009-05-27
$ModLoad imdiag
$IMDiagServerRun 13500
$template startupfile,"rsyslogd.started" # trick to use relative path names!
:syslogtag, contains, "rsyslogd"  ?startupfile
# I have disabled the directive below, so that we see errors in testcase
# creation. I am not sure why it was present in the first place, so for
# now I just leave it commented out -- rgerhards, 2011-03-30
#$ErrorMessagesToStderr off
--- 23:47:38.710 - wait for rsyslogd startup ----------------------------------------------
rsyslogd: error starting up disk queue, using pure in-memory mode [try http://www.rsyslog.com/e/2036 ]
rsyslogd started with pid  15881
--- 23:47:38.832 - run tcpflood -----------------------------------------------------------
00005 open connections
starting run 1
Sending 10000 messages.
00010000 messages sent
runtime: 0.116
sleeping 1 seconds before next run
starting run 2
Sending 10000 messages.
00010000 messages sent
runtime: 0.126
sleeping 1 seconds before next run
starting run 3
Sending 10000 messages.
00010000 messages sent
runtime: 0.114
sleeping 1 seconds before next run
starting run 4
Sending 10000 messages.
00010000 messages sent
runtime: 0.124
sleeping 1 seconds before next run
starting run 5
Sending 10000 messages.
00010000 messages sent
runtime: 0.148
sleeping 1 seconds before next run
starting run 6
Sending 10000 messages.
00010000 messages sent
runtime: 0.127
sleeping 1 seconds before next run
starting run 7
Sending 10000 messages.
00010000 messages sent
runtime: 0.109
sleeping 1 seconds before next run
starting run 8
Sending 10000 messages.
00010000 messages sent
runtime: 0.119
sleeping 1 seconds before next run
starting run 9
Sending 10000 messages.
00010000 messages sent
runtime: 0.077
sleeping 1 seconds before next run
starting run 10
Sending 10000 messages.
00010000 messages sent
runtime: 0.110
Runs:     10
Runtime:
  total:  1.170
  avg:    0.117
  min:    0.077
  max:    0.148
All times are wallclock time.
00005 close connections
End of tcpflood Run
Raw message lenght (Byte):                      230
Messages sent during one tcpflood test:         10000
Number of tcpflood tests:                       10
Seconds to sleep between tcpflood runs:         1
Concurrent tcpflood connections:                5
tcpflood transport protocol:                    tcp
tcpflood rsyslog target port:                   13514
tcpflood rsyslog target address:                127.0.0.1
Total messages:                                 100000
Total tcpflood runtime (milli seconds):         10182
Loging rate (MPS):                              9821
--- 23:47:49.027 - count elasticsearch indexed messages -----------------------------------
37253 messages indexed (1000 milliseconds - Abort in 120000 milliseconds)
74143 messages indexed (2000 milliseconds - Abort in 180000 milliseconds)
74143 messages indexed (3000 milliseconds - Abort in 180000 milliseconds)
74143 messages indexed (4000 milliseconds - Abort in 179000 milliseconds)
74143 messages indexed (5000 milliseconds - Abort in 178000 milliseconds)
74143 messages indexed (6000 milliseconds - Abort in 177000 milliseconds)
100000 messages indexed (7000 milliseconds - Abort in 176000 milliseconds)
--- 23:47:56.280 - show elasticsearch index statistics ------------------------------------
{
  "ok" : true,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "failed" : 0
  },
  "_all" : {
    "primaries" : {
      "docs" : {
        "count" : 100000,
        "deleted" : 0
      },
      "store" : {
        "size" : "77.2mb",
        "size_in_bytes" : 81009144,
        "throttle_time" : "0s",
        "throttle_time_in_millis" : 0
      },
      "indexing" : {
        "index_total" : 100000,
        "index_time" : "12.1s",
        "index_time_in_millis" : 12113,
        "index_current" : 0,
        "delete_total" : 0,
        "delete_time" : "0s",
        "delete_time_in_millis" : 0,
        "delete_current" : 0
      },
      "get" : {
        "total" : 0,
        "time" : "0s",
        "time_in_millis" : 0,
        "exists_total" : 0,
        "exists_time" : "0s",
        "exists_time_in_millis" : 0,
        "missing_total" : 0,
        "missing_time" : "0s",
        "missing_time_in_millis" : 0,
        "current" : 0
      },
      "search" : {
        "query_total" : 0,
        "query_time" : "0s",
        "query_time_in_millis" : 0,
        "query_current" : 0,
        "fetch_total" : 0,
        "fetch_time" : "0s",
        "fetch_time_in_millis" : 0,
        "fetch_current" : 0
      }
    },
    "total" : {
      "docs" : {
        "count" : 100000,
        "deleted" : 0
      },
      "store" : {
        "size" : "77.2mb",
        "size_in_bytes" : 81009144,
        "throttle_time" : "0s",
        "throttle_time_in_millis" : 0
      },
      "indexing" : {
        "index_total" : 100000,
        "index_time" : "12.1s",
        "index_time_in_millis" : 12113,
        "index_current" : 0,
        "delete_total" : 0,
        "delete_time" : "0s",
        "delete_time_in_millis" : 0,
        "delete_current" : 0
      },
      "get" : {
        "total" : 0,
        "time" : "0s",
        "time_in_millis" : 0,
        "exists_total" : 0,
        "exists_time" : "0s",
        "exists_time_in_millis" : 0,
        "missing_total" : 0,
        "missing_time" : "0s",
        "missing_time_in_millis" : 0,
        "current" : 0
      },
      "search" : {
        "query_total" : 0,
        "query_time" : "0s",
        "query_time_in_millis" : 0,
        "query_current" : 0,
        "fetch_total" : 0,
        "fetch_time" : "0s",
        "fetch_time_in_millis" : 0,
        "fetch_current" : 0
      }
    },
    "indices" : {
      "diag-no-compression" : {
        "primaries" : {
          "docs" : {
            "count" : 100000,
            "deleted" : 0
          },
          "store" : {
            "size" : "77.2mb",
            "size_in_bytes" : 81009144,
            "throttle_time" : "0s",
            "throttle_time_in_millis" : 0
          },
          "indexing" : {
            "index_total" : 100000,
            "index_time" : "12.1s",
            "index_time_in_millis" : 12113,
            "index_current" : 0,
            "delete_total" : 0,
            "delete_time" : "0s",
            "delete_time_in_millis" : 0,
            "delete_current" : 0
          },
          "get" : {
            "total" : 0,
            "time" : "0s",
            "time_in_millis" : 0,
            "exists_total" : 0,
            "exists_time" : "0s",
            "exists_time_in_millis" : 0,
            "missing_total" : 0,
            "missing_time" : "0s",
            "missing_time_in_millis" : 0,
            "current" : 0
          },
          "search" : {
            "query_total" : 0,
            "query_time" : "0s",
            "query_time_in_millis" : 0,
            "query_current" : 0,
            "fetch_total" : 0,
            "fetch_time" : "0s",
            "fetch_time_in_millis" : 0,
            "fetch_current" : 0
          }
        },
        "total" : {
          "docs" : {
            "count" : 100000,
            "deleted" : 0
          },
          "store" : {
            "size" : "77.2mb",
            "size_in_bytes" : 81009144,
            "throttle_time" : "0s",
            "throttle_time_in_millis" : 0
          },
          "indexing" : {
            "index_total" : 100000,
            "index_time" : "12.1s",
            "index_time_in_millis" : 12113,
            "index_current" : 0,
            "delete_total" : 0,
            "delete_time" : "0s",
            "delete_time_in_millis" : 0,
            "delete_current" : 0
          },
          "get" : {
            "total" : 0,
            "time" : "0s",
            "time_in_millis" : 0,
            "exists_total" : 0,
            "exists_time" : "0s",
            "exists_time_in_millis" : 0,
            "missing_total" : 0,
            "missing_time" : "0s",
            "missing_time_in_millis" : 0,
            "current" : 0
          },
          "search" : {
            "query_total" : 0,
            "query_time" : "0s",
            "query_time_in_millis" : 0,
            "query_current" : 0,
            "fetch_total" : 0,
            "fetch_time" : "0s",
            "fetch_time_in_millis" : 0,
            "fetch_current" : 0
          }
        }
      }
    }
  }
}
--- 23:47:56.314 - show elasticsearch index status ----------------------------------------
{
  "ok" : true,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "failed" : 0
  },
  "indices" : {
    "diag-no-compression" : {
      "index" : {
        "primary_size" : "77.2mb",
        "primary_size_in_bytes" : 81009144,
        "size" : "77.2mb",
        "size_in_bytes" : 81009144
      },
      "translog" : {
        "operations" : 0
      },
      "docs" : {
        "num_docs" : 100000,
        "max_doc" : 100000,
        "deleted_docs" : 0
      },
      "merges" : {
        "current" : 0,
        "current_docs" : 0,
        "current_size" : "0b",
        "current_size_in_bytes" : 0,
        "total" : 0,
        "total_time" : "0s",
        "total_time_in_millis" : 0,
        "total_docs" : 0,
        "total_size" : "0b",
        "total_size_in_bytes" : 0
      },
      "refresh" : {
        "total" : 1,
        "total_time" : "0s",
        "total_time_in_millis" : 0
      },
      "flush" : {
        "total" : 3,
        "total_time" : "1.8s",
        "total_time_in_millis" : 1879
      },
      "shards" : {
        "0" : [ {
          "routing" : {
            "state" : "STARTED",
            "primary" : true,
            "node" : "pqp3jV5fT7Gc2tULGxLoYg",
            "relocating_node" : null,
            "shard" : 0,
            "index" : "diag-no-compression"
          },
          "state" : "STARTED",
          "index" : {
            "size" : "77.2mb",
            "size_in_bytes" : 81009144
          },
          "translog" : {
            "id" : 1363906059093,
            "operations" : 0
          },
          "docs" : {
            "num_docs" : 100000,
            "max_doc" : 100000,
            "deleted_docs" : 0
          },
          "merges" : {
            "current" : 0,
            "current_docs" : 0,
            "current_size" : "0b",
            "current_size_in_bytes" : 0,
            "total" : 0,
            "total_time" : "0s",
            "total_time_in_millis" : 0,
            "total_docs" : 0,
            "total_size" : "0b",
            "total_size_in_bytes" : 0
          },
          "refresh" : {
            "total" : 1,
            "total_time" : "0s",
            "total_time_in_millis" : 0
          },
          "flush" : {
            "total" : 3,
            "total_time" : "1.8s",
            "total_time_in_millis" : 1879
          }
        } ]
      }
    }
  }
}
--- 23:47:56.335 - show elasticsearch index settings --------------------------------------
{
  "diag-no-compression" : {
    "settings" : {
      "index.query.default_field" : "@message",
      "index.refresh_interval" : "30s",
      "index.number_of_replicas" : "0",
      "index.number_of_shards" : "1",
      "index.store.compress.stored" : "false",
      "index.cache.field.type" : "soft",
      "index.version.created" : "200599"
    }
  }
}
--- 23:47:56.422 - show elasticsearch index mappings --------------------------------------
{
  "diag-no-compression" : {
    "events" : {
      "properties" : {
        "@customer" : {
          "type" : "string",
          "index" : "not_analyzed",
          "omit_norms" : true,
          "index_options" : "docs"
        },
        "@fields" : {
          "dynamic" : "true",
          "properties" : {
            "facility" : {
              "type" : "integer"
            },
            "facility_label" : {
              "type" : "string",
              "index" : "not_analyzed",
              "omit_norms" : true,
              "index_options" : "docs"
            },
            "priority" : {
              "type" : "integer"
            },
            "processid" : {
              "type" : "string",
              "index" : "not_analyzed",
              "omit_norms" : true,
              "index_options" : "docs"
            },
            "program" : {
              "type" : "string",
              "index" : "not_analyzed",
              "omit_norms" : true,
              "index_options" : "docs"
            },
            "severity" : {
              "type" : "integer"
            },
            "severity_label" : {
              "type" : "string",
              "index" : "not_analyzed",
              "omit_norms" : true,
              "index_options" : "docs"
            }
          }
        },
        "@message" : {
          "type" : "string"
        },
        "@source" : {
          "type" : "string",
          "index" : "not_analyzed",
          "omit_norms" : true,
          "index_options" : "docs"
        },
        "@source_host" : {
          "type" : "string",
          "index" : "not_analyzed",
          "omit_norms" : true,
          "index_options" : "docs"
        },
        "@timestamp" : {
          "type" : "date",
          "format" : "dateOptionalTime"
        },
        "@type" : {
          "type" : "string",
          "index" : "not_analyzed",
          "omit_norms" : true,
          "index_options" : "docs"
        }
      }
    }
  }
}
--- 23:47:56.451 - shutdown rsyslogd when main queue is empty -----------------------------
--- 23:47:56.474 - wait for main message queue to be empty --------------------------------
imdiag[13500]: mainqueue empty
--- 23:47:57.243 - wait for rsyslogd shutdown ---------------------------------------------
--- 23:47:57.362 - exit -------------------------------------------------------------------
===========================================================================================
PASS:  (without compression)
-------------------------------------------------------------------------------------------
Raw message lenght (Byte):                              230
Total message lenght (Byte):
Messages sent during one tcpflood test:                 10000
Number of tcpflood tests:                               10
Seconds to sleep between tcpflood runs:                 1
Concurrent tcpflood connections:                        5
tcpflood transport protocol:                            tcp
tcpflood rsyslog target port:                           13514
tcpflood rsyslog target address:                        127.0.0.1
Total messages:                                         100000
Total tcpflood runtime (milli seconds):                 10182
Loging rate (MPS):                                      9821
Transmission speed (MBit/s):
Compressed data size (MByte):
Compressed data indexing runtime (milli seconds):
Compression method:                                     index.store.compress.stored = false
Compression ratio (%):
Decompression runtime (milli seconds):
Uncompressed data size (MByte):                         77.25
Uncompressed data indexing runtime (milli seconds):     12113
===========================================================================================
--- with compression
===========================================================================================
--- 23:47:57.397 - init -------------------------------------------------------------------
--- 23:47:57.439 - delete elasticsearch diag index ----------------------------------------
{"ok":true,"acknowledged":true}
--- 23:47:57.486 - start rsyslogd ---------------------------------------------------------
# author: Joerg Heinemann
# website: http://enterprise-log-management-appliance.org
# license: GPL v3
#
# /opt/elma/config/rsyslog.d/elma_imptcp_elasticsearch.conf
#
# simple async writing test to elasticsearch
# Joerg Heinemann, 2012-12-31
$IncludeConfig /opt/elma/config/rsyslog.d/diag-common.conf
$MaxMessageSize 10k
$ModLoad imptcp
$MainMsgQueueTimeoutShutdown 10000
$InputPTCPServerRun 13514
# ######### Enable In-Memory queues ##########
#
# An in-memory queue is created for this action. If the remote host or
# database is down, messages are spooled to memory and sent when it is
# up again.
#
# The advantages are that it will be consistently good in terms of performance
# and it will fail fast.
#
# The downside is that you can keep a limited number of messages in that queue,
# less than you normally can with a disk-assisted queue.
#
# allocate memory dynamically for the queue. Better for handling spikes
$MainMsgQueueType LinkedList
# how many messages (messages, not bytes!) to hold in memory
$MainMsgQueueSize 2000000
# don't throttle receiving messages when the queue gets full
$MainMsgQueueTimeoutEnqueue 0
# ######### Event forwarding to ElasticSearch ##########
#
# Enable ElasticSearch output
#
$ModLoad omelasticsearch.so
# Template for JSON output
#
#$template ls_json,"{\"@timestamp\":\"%timereported:1:19:date-rfc3339%.%timereported:1:3:date-subseconds%\",\"@source_host\":%source:::jsonf%\",\"@source\":\"syslog://%fromhost-ip:::json%\",\"@message\":\"%timereported% %app-name%:%msg:::json%\",\"@fields\":{%syslogfacility:facility%,%syslogfacility-text:facility_label%,%syslogseverity:severity%,%syslogseverity-text:severity_label%,%pri:priority%,%app-name:program%,%procid:processid%},\"@customer\":\"AIDB\"}"
$template ls_json,"{%timestamp:::date-rfc3339,jsonf:@timestamp%,%source:::jsonf:@source_host%,\"@source\":\"syslog://%fromhost-ip:::json%\",\"@message\":\"%timestamp% %app-name%:%msg:::json%\",\"@fields\":{%syslogfacility:::jsonf:facility%,%syslogfacility-text:::jsonf:facility_label%,%syslogseverity:::jsonf:severity%,%syslogseverity-text:::jsonf:severity_label%,%pri:::jsonf:priority%,%app-name:::jsonf:program%,%procid:::jsonf:processid%},\"@customer\":\"AIDB\",\"@type\":\"events\"}"
$template srchidx,"diag"
# now we put everything together
# "template" is for storing the syslog fields we want
#
local4.* action(type="omelasticsearch"
                template="ls_json"
                searchIndex="srchidx"
                dynSearchIndex="on"
                asyncrepl="on"
                searchType="events"
                server="localhost"
                serverport="9200"
#                uid="elma"
#                pwd="fjg892345sdfsdwf43d"
                bulkmode="on"
                queue.dequeuebatchsize="65536"
                queue.type="linkedlist"
                queue.filename="dbq"
                queue.highwatermark="500000"
                queue.lowwatermark="400000"
                queue.discardmark="2000000"
                queue.timeoutenqueue="0"
                queue.maxdiskspace="5g"
                queue.size="2000000"
                queue.saveonshutdown="on"
                action.resumeretrycount="-1")
# There are some other nice things you can use:
#
#    searchIndex               - for letting rsyslog know where to get these names
#    dynSearchIndex="on"       - for having variable index names
#    searchType="mycustomtype" - to specify a different type than "events".
#                                You can have dynSearchType="on" to have it variable, like you can with indices.
#    serverport="9200"         - the default setting, but you can specify a different port
#    asyncrepl="on"            - to enable asyncronous replication.
#                                That is, Elasticsearch gives an answer imediately
#                                after inserting to the main shard(s).
#                                It doesn't wait for replicas to be updated as well, which is the default setting
#    timeout="1m"              - how long to wait for a reply from Elasticsearch.
#                                More info here, near the end:
#                                http://www.elasticsearch.org/guide/reference/api/index_.html
# /opt/elma/config/rsyslog.d/diag-common.conf
#
# This is a config include file. It sets up rsyslog so that the
# diag system can successfully be used. Also, it generates a file
# "rsyslogd.started" after rsyslogd is initialized. This config file
# should be included in all tests that intend to use common code for
# controlling the daemon.
# NOTE: we assume that rsyslogd's current working directory is
# ./tests (or the distcheck equivalent), in particlular that this
# config file resides in the testsuites subdirectory.
# rgerhards, 2009-05-27
$ModLoad imdiag
$IMDiagServerRun 13500
$template startupfile,"rsyslogd.started" # trick to use relative path names!
:syslogtag, contains, "rsyslogd"  ?startupfile
# I have disabled the directive below, so that we see errors in testcase
# creation. I am not sure why it was present in the first place, so for
# now I just leave it commented out -- rgerhards, 2011-03-30
#$ErrorMessagesToStderr off
--- 23:47:57.608 - wait for rsyslogd startup ----------------------------------------------
rsyslogd: error starting up disk queue, using pure in-memory mode [try http://www.rsyslog.com/e/2036 ]
rsyslogd started with pid  16053
--- 23:47:57.727 - run tcpflood -----------------------------------------------------------
00005 open connections
starting run 1
Sending 10000 messages.
00010000 messages sent
runtime: 0.186
sleeping 1 seconds before next run
starting run 2
Sending 10000 messages.
00010000 messages sent
runtime: 0.088
sleeping 1 seconds before next run
starting run 3
Sending 10000 messages.
00010000 messages sent
runtime: 0.162
sleeping 1 seconds before next run
starting run 4
Sending 10000 messages.
00010000 messages sent
runtime: 0.084
sleeping 1 seconds before next run
starting run 5
Sending 10000 messages.
00010000 messages sent
runtime: 0.131
sleeping 1 seconds before next run
starting run 6
Sending 10000 messages.
00010000 messages sent
runtime: 0.079
sleeping 1 seconds before next run
starting run 7
Sending 10000 messages.
00010000 messages sent
runtime: 0.093
sleeping 1 seconds before next run
starting run 8
Sending 10000 messages.
00010000 messages sent
runtime: 0.123
sleeping 1 seconds before next run
starting run 9
Sending 10000 messages.
00010000 messages sent
runtime: 0.130
sleeping 1 seconds before next run
starting run 10
Sending 10000 messages.
00010000 messages sent
runtime: 0.101
Runs:     10
Runtime:
  total:  1.177
  avg:    0.117
  min:    0.079
  max:    0.186
All times are wallclock time.
00005 close connections
End of tcpflood Run
Raw message lenght (Byte):                      230
Messages sent during one tcpflood test:         10000
Number of tcpflood tests:                       10
Seconds to sleep between tcpflood runs:         1
Concurrent tcpflood connections:                5
tcpflood transport protocol:                    tcp
tcpflood rsyslog target port:                   13514
tcpflood rsyslog target address:                127.0.0.1
Total messages:                                 100000
Total tcpflood runtime (milli seconds):         10190
Loging rate (MPS):                              9813
--- 23:48:07.929 - count elasticsearch indexed messages -----------------------------------
40177 messages indexed (8000 milliseconds - Abort in 120000 milliseconds)
81311 messages indexed (9000 milliseconds - Abort in 180000 milliseconds)
81311 messages indexed (10000 milliseconds - Abort in 180000 milliseconds)
81311 messages indexed (11000 milliseconds - Abort in 179000 milliseconds)
81311 messages indexed (12000 milliseconds - Abort in 178000 milliseconds)
81311 messages indexed (13000 milliseconds - Abort in 177000 milliseconds)
100000 messages indexed (14000 milliseconds - Abort in 176000 milliseconds)
--- 23:48:15.065 - show elasticsearch index statistics ------------------------------------
{
  "ok" : true,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "failed" : 0
  },
  "_all" : {
    "primaries" : {
      "docs" : {
        "count" : 100000,
        "deleted" : 0
      },
      "store" : {
        "size" : "23.4mb",
        "size_in_bytes" : 24585756,
        "throttle_time" : "0s",
        "throttle_time_in_millis" : 0
      },
      "indexing" : {
        "index_total" : 100000,
        "index_time" : "11.3s",
        "index_time_in_millis" : 11353,
        "index_current" : 0,
        "delete_total" : 0,
        "delete_time" : "0s",
        "delete_time_in_millis" : 0,
        "delete_current" : 0
      },
      "get" : {
        "total" : 0,
        "time" : "0s",
        "time_in_millis" : 0,
        "exists_total" : 0,
        "exists_time" : "0s",
        "exists_time_in_millis" : 0,
        "missing_total" : 0,
        "missing_time" : "0s",
        "missing_time_in_millis" : 0,
        "current" : 0
      },
      "search" : {
        "query_total" : 0,
        "query_time" : "0s",
        "query_time_in_millis" : 0,
        "query_current" : 0,
        "fetch_total" : 0,
        "fetch_time" : "0s",
        "fetch_time_in_millis" : 0,
        "fetch_current" : 0
      }
    },
    "total" : {
      "docs" : {
        "count" : 100000,
        "deleted" : 0
      },
      "store" : {
        "size" : "23.4mb",
        "size_in_bytes" : 24585756,
        "throttle_time" : "0s",
        "throttle_time_in_millis" : 0
      },
      "indexing" : {
        "index_total" : 100000,
        "index_time" : "11.3s",
        "index_time_in_millis" : 11353,
        "index_current" : 0,
        "delete_total" : 0,
        "delete_time" : "0s",
        "delete_time_in_millis" : 0,
        "delete_current" : 0
      },
      "get" : {
        "total" : 0,
        "time" : "0s",
        "time_in_millis" : 0,
        "exists_total" : 0,
        "exists_time" : "0s",
        "exists_time_in_millis" : 0,
        "missing_total" : 0,
        "missing_time" : "0s",
        "missing_time_in_millis" : 0,
        "current" : 0
      },
      "search" : {
        "query_total" : 0,
        "query_time" : "0s",
        "query_time_in_millis" : 0,
        "query_current" : 0,
        "fetch_total" : 0,
        "fetch_time" : "0s",
        "fetch_time_in_millis" : 0,
        "fetch_current" : 0
      }
    },
    "indices" : {
      "diag" : {
        "primaries" : {
          "docs" : {
            "count" : 100000,
            "deleted" : 0
          },
          "store" : {
            "size" : "23.4mb",
            "size_in_bytes" : 24585756,
            "throttle_time" : "0s",
            "throttle_time_in_millis" : 0
          },
          "indexing" : {
            "index_total" : 100000,
            "index_time" : "11.3s",
            "index_time_in_millis" : 11353,
            "index_current" : 0,
            "delete_total" : 0,
            "delete_time" : "0s",
            "delete_time_in_millis" : 0,
            "delete_current" : 0
          },
          "get" : {
            "total" : 0,
            "time" : "0s",
            "time_in_millis" : 0,
            "exists_total" : 0,
            "exists_time" : "0s",
            "exists_time_in_millis" : 0,
            "missing_total" : 0,
            "missing_time" : "0s",
            "missing_time_in_millis" : 0,
            "current" : 0
          },
          "search" : {
            "query_total" : 0,
            "query_time" : "0s",
            "query_time_in_millis" : 0,
            "query_current" : 0,
            "fetch_total" : 0,
            "fetch_time" : "0s",
            "fetch_time_in_millis" : 0,
            "fetch_current" : 0
          }
        },
        "total" : {
          "docs" : {
            "count" : 100000,
            "deleted" : 0
          },
          "store" : {
            "size" : "23.4mb",
            "size_in_bytes" : 24585756,
            "throttle_time" : "0s",
            "throttle_time_in_millis" : 0
          },
          "indexing" : {
            "index_total" : 100000,
            "index_time" : "11.3s",
            "index_time_in_millis" : 11353,
            "index_current" : 0,
            "delete_total" : 0,
            "delete_time" : "0s",
            "delete_time_in_millis" : 0,
            "delete_current" : 0
          },
          "get" : {
            "total" : 0,
            "time" : "0s",
            "time_in_millis" : 0,
            "exists_total" : 0,
            "exists_time" : "0s",
            "exists_time_in_millis" : 0,
            "missing_total" : 0,
            "missing_time" : "0s",
            "missing_time_in_millis" : 0,
            "current" : 0
          },
          "search" : {
            "query_total" : 0,
            "query_time" : "0s",
            "query_time_in_millis" : 0,
            "query_current" : 0,
            "fetch_total" : 0,
            "fetch_time" : "0s",
            "fetch_time_in_millis" : 0,
            "fetch_current" : 0
          }
        }
      }
    }
  }
}
--- 23:48:15.104 - show elasticsearch index status ----------------------------------------
{
  "ok" : true,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "failed" : 0
  },
  "indices" : {
    "diag" : {
      "index" : {
        "primary_size" : "23.4mb",
        "primary_size_in_bytes" : 24585756,
        "size" : "23.4mb",
        "size_in_bytes" : 24585756
      },
      "translog" : {
        "operations" : 0
      },
      "docs" : {
        "num_docs" : 100000,
        "max_doc" : 100000,
        "deleted_docs" : 0
      },
      "merges" : {
        "current" : 0,
        "current_docs" : 0,
        "current_size" : "0b",
        "current_size_in_bytes" : 0,
        "total" : 0,
        "total_time" : "0s",
        "total_time_in_millis" : 0,
        "total_docs" : 0,
        "total_size" : "0b",
        "total_size_in_bytes" : 0
      },
      "refresh" : {
        "total" : 1,
        "total_time" : "0s",
        "total_time_in_millis" : 0
      },
      "flush" : {
        "total" : 3,
        "total_time" : "1.6s",
        "total_time_in_millis" : 1656
      },
      "shards" : {
        "0" : [ {
          "routing" : {
            "state" : "STARTED",
            "primary" : true,
            "node" : "pqp3jV5fT7Gc2tULGxLoYg",
            "relocating_node" : null,
            "shard" : 0,
            "index" : "diag"
          },
          "state" : "STARTED",
          "index" : {
            "size" : "23.4mb",
            "size_in_bytes" : 24585756
          },
          "translog" : {
            "id" : 1363906077910,
            "operations" : 0
          },
          "docs" : {
            "num_docs" : 100000,
            "max_doc" : 100000,
            "deleted_docs" : 0
          },
          "merges" : {
            "current" : 0,
            "current_docs" : 0,
            "current_size" : "0b",
            "current_size_in_bytes" : 0,
            "total" : 0,
            "total_time" : "0s",
            "total_time_in_millis" : 0,
            "total_docs" : 0,
            "total_size" : "0b",
            "total_size_in_bytes" : 0
          },
          "refresh" : {
            "total" : 1,
            "total_time" : "0s",
            "total_time_in_millis" : 0
          },
          "flush" : {
            "total" : 3,
            "total_time" : "1.6s",
            "total_time_in_millis" : 1656
          }
        } ]
      }
    }
  }
}
--- 23:48:15.126 - show elasticsearch index settings --------------------------------------
{
  "diag" : {
    "settings" : {
      "index.query.default_field" : "@message",
      "index.refresh_interval" : "30s",
      "index.number_of_replicas" : "0",
      "index.number_of_shards" : "1",
      "index.store.compress.stored" : "true",
      "index.cache.field.type" : "soft",
      "index.version.created" : "200599"
    }
  }
}
--- 23:48:15.217 - show elasticsearch index mappings --------------------------------------
{
  "diag" : {
    "events" : {
      "properties" : {
        "@customer" : {
          "type" : "string",
          "index" : "not_analyzed",
          "omit_norms" : true,
          "index_options" : "docs"
        },
        "@fields" : {
          "dynamic" : "true",
          "properties" : {
            "facility" : {
              "type" : "integer"
            },
            "facility_label" : {
              "type" : "string",
              "index" : "not_analyzed",
              "omit_norms" : true,
              "index_options" : "docs"
            },
            "priority" : {
              "type" : "integer"
            },
            "processid" : {
              "type" : "string",
              "index" : "not_analyzed",
              "omit_norms" : true,
              "index_options" : "docs"
            },
            "program" : {
              "type" : "string",
              "index" : "not_analyzed",
              "omit_norms" : true,
              "index_options" : "docs"
            },
            "severity" : {
              "type" : "integer"
            },
            "severity_label" : {
              "type" : "string",
              "index" : "not_analyzed",
              "omit_norms" : true,
              "index_options" : "docs"
            }
          }
        },
        "@message" : {
          "type" : "string"
        },
        "@source" : {
          "type" : "string",
          "index" : "not_analyzed",
          "omit_norms" : true,
          "index_options" : "docs"
        },
        "@source_host" : {
          "type" : "string",
          "index" : "not_analyzed",
          "omit_norms" : true,
          "index_options" : "docs"
        },
        "@timestamp" : {
          "type" : "date",
          "format" : "dateOptionalTime"
        },
        "@type" : {
          "type" : "string",
          "index" : "not_analyzed",
          "omit_norms" : true,
          "index_options" : "docs"
        }
      }
    }
  }
}
--- 23:48:15.240 - shutdown rsyslogd when main queue is empty -----------------------------
--- 23:48:15.254 - wait for main message queue to be empty --------------------------------
imdiag[13500]: mainqueue empty
--- 23:48:16.044 - wait for rsyslogd shutdown ---------------------------------------------
--- 23:48:16.059 - exit -------------------------------------------------------------------
===========================================================================================
PASS:   (with compression)
-------------------------------------------------------------------------------------------
Raw message lenght (Byte):                              230
Total message lenght (Byte):
Messages sent during one tcpflood test:                 10000
Number of tcpflood tests:                               10
Seconds to sleep between tcpflood runs:                 1
Concurrent tcpflood connections:                        5
tcpflood transport protocol:                            tcp
tcpflood rsyslog target port:                           13514
tcpflood rsyslog target address:                        127.0.0.1
Total messages:                                         100000
Total tcpflood runtime (milli seconds):                 10190
Loging rate (MPS):                                      9813
Transmission speed (MBit/s):
Compressed data size (MByte):                           23.44
Compressed data indexing runtime (milli seconds):       11353
Compression method:                                     index.store.compress.stored = true
Compression ratio (%):                                  69.65
Decompression runtime (milli seconds):
Uncompressed data size (MByte):                         77.25
Uncompressed data indexing runtime (milli seconds):     12113
===========================================================================================</pre>
</div>
</div>


      &nbsp;
    </div>
      
  </div>
</div>
<footer id="footer">
  <div class="container">
    <div class="text-muted footer">
      &copy; Joerg Heinemann 2012-2014 - Provided by <a href="http://enterprise-log-management-appliance.org" target="_blank">http://enterprise-log-management-appliance.org</a>
         - Last updated on Oct 02, 2014.
      <span class="pull-right">
        <a href="#">Back to top</a>
      </span>
    </div>
  </div>
</footer>
  </body>
</html>