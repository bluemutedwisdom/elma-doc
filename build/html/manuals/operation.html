

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Operation Guide &mdash; ELMA 0.2.6 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="ELMA 0.2.6 documentation" href="../index.html" />
    <link rel="up" title="Manuals" href="index.html" />
    <link rel="next" title="User Guide" href="user.html" />
    <link rel="prev" title="Administration Guide" href="administration.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="user.html" title="User Guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="administration.html" title="Administration Guide"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">ELMA 0.2.6 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Manuals</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="operation-guide">
<h1>Operation Guide<a class="headerlink" href="#operation-guide" title="Permalink to this headline">¶</a></h1>
<p>This HOWTO describes a range of potential common problems and their
solutions.</p>
<p>If your situation is not precisely listed here, there may be one on
<a class="reference external" href="http://activedoc.opensuse.org/book/opensuse-start-up/appendix-a-help-and-troubleshooting">openSUSE Help and
Troubleshooting</a>
site. For more detailed installation instructions and deployment
strategies, see the <a class="reference external" href="http://doc.opensuse.org/">openSUSE
documentation</a>.</p>
<div class="section" id="basic-knowledge">
<h2>Basic Knowledge<a class="headerlink" href="#basic-knowledge" title="Permalink to this headline">¶</a></h2>
<p>ELMA appliance comes out of the box without any Linux graphical user
interface. Therefore it is useful to have some basic knowledge of
working with <a class="reference external" href="https://activedoc.opensuse.org/book/opensuse-security-guide/chapter-12-ssh-secure-network-operations">OpenSSH
utilities</a>
and Linux shell because some operation and administration tasks only can
be done with shell commands.</p>
</div>
<div class="section" id="secure-network-operations">
<h2>Secure Network Operations<a class="headerlink" href="#secure-network-operations" title="Permalink to this headline">¶</a></h2>
<p>In networked environments, it is often necessary to access hosts from a
remote location. The SSH implementation coming with openSUSE is OpenSSH
and provides the necessary protection by encrypting the authentication
strings (usually a login name and a password) and all the other data
exchanged between the hosts.</p>
<p>openSUSE installs the OpenSSH package by default providing the commands:</p>
<div class="highlight-python"><pre>ssh, scp, and sftp</pre>
</div>
<p>In the default configuration, remote access of a openSUSE system is only
possible with the OpenSSH utilities, and only if the sshd is running and
the firewall permits access.</p>
<div class="section" id="secure-shell">
<h3>Secure Shell<a class="headerlink" href="#secure-shell" title="Permalink to this headline">¶</a></h3>
<p>By using the ssh program, it is possible to log in to remote systems and
to work interactively. To log in to the host elma as user tux use one of
the following commands:</p>
<div class="highlight-python"><pre>ssh tux@elma
ssh -l tux elma</pre>
</div>
<p>If the username is the same on both machines, you may omit it:</p>
<div class="highlight-python"><pre>ssh elma</pre>
</div>
<p>The remote host prompts for the remote user&#8217;s password. After a
successful authentication, you can work on the remote command line or
use interactive applications, such as YaST in text mode.</p>
<p>The default shell in openSUSE is Bash (GNU Bourne-Again Shell).</p>
</div>
</div>
<div class="section" id="event-and-trap-generation-for-specific-testing">
<h2>Event and trap generation for specific testing<a class="headerlink" href="#event-and-trap-generation-for-specific-testing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="snmp-trap">
<h3>SNMP trap<a class="headerlink" href="#snmp-trap" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">net-snmp tools</p>
<div class="highlight-python"><pre>snmptrap -v 1 -c public 127.0.0.1 .1.3.6.1 localhost 6 17 '' .1.3.6.1 s "Just a test ;-)"</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="syslog-event">
<h3>Syslog event<a class="headerlink" href="#syslog-event" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><a class="reference external" href="http://www.rsyslog.com/how-to-use-tcpflood/">rsyslog traffic
generator</a> - rsyslog
test and benchmark suite</p>
<div class="highlight-python"><pre>tcpflood -X -m2 -R2 -S1 -t127.0.0.1 -Ttcp -p514

00001 open connections
starting run 1
Sending 2 messages.
00000002 messages sent
runtime: 0.001
sleeping 1 seconds before next run
starting run 2
Sending 2 messages.
00000002 messages sent
runtime: 0.000
Runs:     2
Runtime:
  total:  0.001
  avg:    0.000
  min:    0.000
  max:    0.001
All times are wallclock time.
00001 close connections
End of tcpflood Run</pre>
</div>
</li>
<li><p class="first">Using logger to Make System Log Entries</p>
<p>logger is a tool for making entries in the system log. It provides a
shell command interface to the syslog(3) system log module. For
example, the following line outputs its message in /var/log/messages:</p>
<div class="highlight-python"><pre>logger -t Test 'This messages comes from $USER'</pre>
</div>
<p>Depending on the current user and hostname, /var/log/messages
contains a line similar to this:</p>
<div class="highlight-python"><pre>Sep 28 13:09:31 venus Test: This messages comes from tux</pre>
</div>
</li>
<li><p class="first">Feeding rsyslog witch Common Event Expression - CEE enhanced syslog</p>
<div class="highlight-python"><pre>logger 'This is a message with a CEE cookie for enhanced syslog @cee: {"customer": "ELMA", "country_code": "DE"}'</pre>
</div>
</li>
<li><p class="first"><a class="reference external" href="http://www.kiwisyslog.com/downloads.aspx">Kiwi SyslogGen</a> - a
Free Syslog message generator for Windows</p>
</li>
</ul>
<p>Results of <a class="reference external" href="../tests">Test and performance tuning</a>.</p>
</div>
</div>
<div class="section" id="basic-operations">
<h2>Basic operations<a class="headerlink" href="#basic-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="elma-reconfigure-and-restart">
<h3>ELMA reconfigure and restart<a class="headerlink" href="#elma-reconfigure-and-restart" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Distribution script elma-reconfigure</p>
<div class="highlight-python"><pre>/usr/share/elma/bin/elma-reconfigure.sh --help

Options:

--help                    Display this help message and exit

--all                     Reconfigure all below services
--apache                  Reconfigure Apache2 web service
--collectd                Reconfigure collectd service
--config-status           Check ELMA config file differences
--diag                    System diagnostics - File system checks and cleanup
--dns                     Reconfigure DNS service
--elasticsearch           Reconfigure elasticsearch service
--firewall                Reconfigure services to be configured during first boot
--firstboot               Reconfigure SuSEfirewall service
--ftp                     Reconfigure FTP service
--install                 Install required system packages
--internet                Check internet access
--kibana                  Reconfigure Kibana3 service
--logstash                Reconfigure logstash service
--nagios                  Reconfigure Nagios service
--network                 Reconfigure Network service
--ntp                     Reconfigure NTP service
--patch                   Apply needed patches
--patch-config            Patch ELMA config file
--postfix                 Reconfigure postfix service
--proxy                   Reconfigure proxy configuration
--reboot                  System reboot
--repositories            Reconfigure system distribution repositories
--reset                   Reset ELMA configuration parameter to factory defaults
--rsyslog                 Reconfigure rsyslog service
--snmp                    Reconfigure snmpd service
--snmptrap                Reconfigure snmptrapd service
--update                  Update system packages to newest available versions
--webyast                 Reconfigure webyast service</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="time-synchronization">
<h3>Time synchronization<a class="headerlink" href="#time-synchronization" title="Permalink to this headline">¶</a></h3>
<p>Wrong timpstamp in ELMA Search-Gui - Is your system time synchronized
and up to date?</p>
<p>One of the quickest commands to verify that ntpd is still up and running
as desired is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ntpq</span> <span class="o">-</span><span class="n">p</span>
</pre></div>
</div>
<p>To compare time offsets between local system time and time taken from
your ntp server:</p>
<div class="highlight-python"><pre>ntpdate -d server</pre>
</div>
<p>To synchronize your system time manually:</p>
<div class="highlight-python"><pre>systemctl stop ntp.service
ntpdate server
systemctl start ntp.service</pre>
</div>
</div>
<div class="section" id="delete-and-optimize-of-time-based-indices">
<h3>Delete and optimize of time-based indices<a class="headerlink" href="#delete-and-optimize-of-time-based-indices" title="Permalink to this headline">¶</a></h3>
<p>Old time-based indices logs have to be removed in a nightly cron job.</p>
<p>Optimizing indices is also a good thing to do at off-peak times, because
it improves your search speed. This is recommended especially when you
have time-based indices, because (with the exception of the “current”
one) they never change, so you only have to do this once on an “old”
index.</p>
<ul class="simple">
<li>ElasticSearch index optimization</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>/etc/cron.d/elma-elasticsearch.sh</pre>
</div>
</div></blockquote>
</div>
<div class="section" id="backup-of-system-configurations">
<h3>Backup of system configurations<a class="headerlink" href="#backup-of-system-configurations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>System configuration backup cron job</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>/etc/cron.d/elma-config-backup.sh</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>Delete backup cron job</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>/etc/cron.d/elma-delete-backup.sh</pre>
</div>
</div></blockquote>
</div>
<div class="section" id="systemd-system-and-service-manager">
<h3>systemd system and service manager<a class="headerlink" href="#systemd-system-and-service-manager" title="Permalink to this headline">¶</a></h3>
<p>Starting with openSUSE 12.x
<a class="reference external" href="https://activedoc.opensuse.org/book/opensuse-123-reference/chapter-8-the-systemd-daemon">systemd</a>
is a replacement for the popular SysV init daemon.</p>
<p>The program systemd is the process with process ID 1. It is responsible
for initializing the system in the required way. systemd is started
directly by the Kernel and resists signal 9, which normally kills
processes. All other programs are either started directly by systemd or
by one of its child processes.</p>
<ul class="simple">
<li>Basic Usage</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>systemctl [ enable | disable | start | stop | restart | reload | status ] &lt;my_service(s)&gt;.service</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>Managing main ELMA services</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>systemctl status apache2.service

apache2.service - apache
          Loaded: loaded (/lib/systemd/system/apache2.service; enabled)
          Active: active (running) since Thu, 2013-07-04 19:04:47 CEST; 11min ago
         Process: 1430 ExecStart=/usr/sbin/start_apache2 -D SYSTEMD -k start (code=exited, status=0/SUCCESS)
        Main PID: 1861 (httpd2-prefork)
          CGroup: name=systemd:/system/apache2.service
                    1861 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
                    1910 PassengerWatchdog
                    1913 PassengerHelperAgent
                    1915 Passenger spawn server
                    1918 PassengerLoggingAgent
                    1927 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
                    1928 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
                    1929 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
                    1930 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
                    1931 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start

Jul 04 19:04:47 elma-es.fritz.box systemd[1]: Started apache.</pre>
</div>
<div class="highlight-python"><pre>systemctl status nagios.service

nagios.service - LSB: Network monitor Nagios
          Loaded: loaded (/etc/init.d/nagios)
          Active: active (running) since Thu, 2013-07-04 19:04:47 CEST; 12min ago
         Process: 1717 ExecStart=/etc/init.d/nagios start (code=exited, status=0/SUCCESS)
          CGroup: name=systemd:/system/nagios.service
                    1899 /usr/sbin/nagios -d /etc/nagios/nagios.cfg

Jul 04 19:10:37 elma-es.fritz.box nagios[1899]: SERVICE ALERT: elma-es.fritz.box;NTP Peer;CRITICAL;HARD;4;NTP CRITICAL: Server not synchronized, Offset unknown
Jul 04 19:10:37 elma-es.fritz.box nagios[1899]: SERVICE FLAPPING ALERT: elma-es.fritz.box;NTP Peer;STARTED; Service appears to have started flapping (23....hreshold)
Jul 04 19:11:17 elma-es.fritz.box nagios[1899]: SERVICE ALERT: elma-es.fritz.box;Syslog Queue;UNKNOWN;HARD;4;**ePN /usr/lib/nagios/plugins/check_files.pl...ne 755,".
Jul 04 19:11:17 elma-es.fritz.box nagios[1899]: SERVICE NOTIFICATION: nagiosadmin;elma-es.fritz.box;Syslog Queue;UNKNOWN;notify-service-by-email;**ePN /u...ine 755,.
Jul 04 19:11:17 elma-es.fritz.box nagios[1899]: SERVICE NOTIFICATION: admin;elma-es.fritz.box;Syslog Queue;UNKNOWN;notify-service-by-email;**ePN /usr/lib...ine 755,.
Jul 04 19:13:37 elma-es.fritz.box sudo[2918]: pam_unix(sudo:auth): conversation failed
Jul 04 19:13:37 elma-es.fritz.box sudo[2918]: pam_unix(sudo:auth): auth could not identify password for [root]
Jul 04 19:13:47 elma-es.fritz.box nagios[1899]: SERVICE ALERT: elma-es.fritz.box;Network Interfaces;OK;HARD;4;eth0:UP (0.0Mbps/0.0Mbps/0.0/0.0/24.0/0.0):(1 UP): OK
Jul 04 19:13:47 elma-es.fritz.box nagios[1899]: SERVICE FLAPPING ALERT: elma-es.fritz.box;Network Interfaces;STARTED; Service appears to have started fla...hreshold)
Jul 04 19:15:37 elma-es.fritz.box nagios[1899]: SERVICE ALERT: elma-es.fritz.box;NTP Peer;WARNING;HARD;4;NTP WARNING: Server has the LI_ALARM bit set, Of...0967 secs</pre>
</div>
<div class="highlight-python"><pre>systemctl status elasticsearch.service

elasticsearch.service - elasticsearch
          Loaded: loaded (/usr/lib/systemd/system/elasticsearch.service; enabled)
          Active: active (running) since Thu, 2013-07-04 19:04:45 CEST; 14min ago
            Docs: http://www.elasticsearch.org
         Process: 1429 ExecStart=/opt/elasticsearch-0.90.0/bin/elasticsearch -p /var/run/elasticsearch.pid -Des.max-open-files=true -Des.bootstrap.mlockall=true -Des.cluster.name=$ES_CLUSTER_NAME -Des.node.name=$ES_NODE_NAME -Des.config=$CONF_FILE -Des.path.home=$ES_HOME -Des.path.logs=$LOG_DIR -Des.path.data=$DATA_DIR -Des.path.work=$WORK_DIR -Des.path.conf=$CONF_DIR -Des.path.plugins=$ES_PLUGIN_DIR (code=exited, status=0/SUCCESS)
        Main PID: 1476 (java)
          CGroup: name=systemd:/system/elasticsearch.service
                    1476 java -Xms2g -Xmx2g -Xss256k -Djava.awt.headless=true -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX...

Jul 04 19:04:45 elma-es.fritz.box systemd[1]: Starting elasticsearch...
Jul 04 19:04:45 elma-es.fritz.box systemd[1]: Started elasticsearch.
Jul 04 19:04:52 elma-es.fritz.box elasticsearch[1429]: [2013-07-04 19:04:52,006][INFO ][bootstrap                ] max_open_files [63974]</pre>
</div>
<div class="highlight-python"><pre>systemctl status rsyslog.service

rsyslog.service - System Logging Service
          Loaded: loaded (/usr/lib/systemd/system/rsyslog.service; enabled)
          Active: active (running) since Thu, 2013-07-04 19:04:42 CEST; 15min ago
         Process: 482 ExecStartPre=/usr/sbin/rsyslog-service-prepare (code=exited, status=0/SUCCESS)
        Main PID: 497 (rsyslogd)
          CGroup: name=systemd:/system/rsyslog.service
                    497 /usr/sbin/rsyslogd -n

Jul 04 19:04:42 elma-es.fritz.box systemd[1]: Started System Logging Service.</pre>
</div>
</div></blockquote>
</div>
<div class="section" id="opensuse-firewall">
<h3>openSUSE firewall<a class="headerlink" href="#opensuse-firewall" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Basic Usage</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>systemctl stop SuSEfirewall2.service
systemctl start SuSEfirewall2.service
systemctl restart SuSEfirewall2.service</pre>
</div>
</div></blockquote>
</div>
<div class="section" id="process-table">
<h3>Process table<a class="headerlink" href="#process-table" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>View all <strong>running processes</strong></li>
</ul>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">ps</span> <span class="o">-</span><span class="n">ef</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>rsyslogd process</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>ps -ef | grep syslog

root       515     1  0 18:31 ?        00:00:00 /usr/sbin/rsyslogd -n</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>ElasticSearch JAVA process</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>ps -ef | grep elasticsearch

elastic+  1664     1  2 18:32 ?        00:00:43 java -Xms2g -Xmx2g -Xss256k -Djava.awt.headless=true -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:+HeapDumpOnOutOfMemoryError -Delasticsearch -Des.pidfile=/var/run/elasticsearch.pid -Des.path.home=/opt/elasticsearch-0.90.0 -cp :/opt/elasticsearch-0.90.0/lib/elasticsearch-0.90.0.jar:/opt/elasticsearch-0.90.0/lib/*:/opt/elasticsearch-0.90.0/lib/sigar/* -Des.max-open-files=true -Des.bootstrap.mlockall=true -Des.cluster.name=elma -Des.node.name=elma-es.fritz.box -Des.config=/etc/elasticsearch/elasticsearch.yml -Des.path.home=/opt/elasticsearch-0.90.0 -Des.path.logs=/var/log/elasticsearch -Des.path.data=/data -Des.path.work=/data/tmp -Des.path.conf=/etc/elasticsearch -Des.path.plugins=/opt/elasticsearch-0.90.0/plugins org.elasticsearch.bootstrap.ElasticSearch</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>Apache2 processes</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>ps -ef | grep apache

root      1884     1  0 18:32 ?        00:00:00 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
wwwrun    1910  1884  0 18:32 ?        00:00:00 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
wwwrun    1911  1884  0 18:32 ?        00:00:00 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
wwwrun    1912  1884  0 18:32 ?        00:00:00 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
wwwrun    1913  1884  0 18:32 ?        00:00:00 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start
wwwrun    1914  1884  0 18:32 ?        00:00:00 /usr/sbin/httpd2-prefork -f /etc/apache2/httpd.conf -DSSL -D SYSTEMD -k start</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>Nagios processes</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>ps -ef | grep nagios

nagios    1679     1  0 18:32 ?        00:00:00 /usr/sbin/nrpe -c /etc/nrpe.cfg -d
nagios    1915     1  0 18:32 ?        00:00:02 /usr/sbin/nagios -d /etc/nagios/nagios.cfg</pre>
</div>
</div></blockquote>
</div>
<div class="section" id="log-files">
<h3>Log files<a class="headerlink" href="#log-files" title="Permalink to this headline">¶</a></h3>
<p>There are several places to look when you encounter problems with your
system. Following a list of the most frequently checked <a class="reference external" href="http://activedoc.opensuse.org/book/opensuse-system-analysis-and-tuning-guide/chapter-4-analyzing-and-managing-system-log-files">log
files</a>
follows with the description of their typical purpose.</p>
<ul class="simple">
<li>Operation system</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>/var/log/boot.msg - Messages from the kernel reported during the boot process
/var/log/messages - Ongoing messages from the kernel and system log daemon (when running)
/var/log/warn - All messages from the kernel and system log daemon with the warning level or higher
/var/log/wtmp - Binary file containing user login records for the current machine session (View it with last)
/var/log/YaST2/ - Directory containing YaST's actions and their results
/var/log/zypper.log - Log file of zypper</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>Apache2</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>/var/log/apache2/access_log
/var/log/apache2/error_log
/var/log/apache2/ssl_request_log</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>ElasticSearch</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>/var/log/elasticsearch/elma.log
/var/log/elasticsearch/elma_index_indexing_slowlog.log
/var/log/elasticsearch/elma_index_search_slowlog.log</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>ELMA installation</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>/var/log/elma/</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>Nagios</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>/var/log/nagios/</pre>
</div>
</div></blockquote>
</div>
<div class="section" id="storage-devices-and-disk-partitions">
<h3>Storage devices and disk partitions<a class="headerlink" href="#storage-devices-and-disk-partitions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>View all <strong>available storage devices</strong> attached to your appliance</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>cat /proc/partitions

major minor  #blocks  name

 253        0   25165824 vda
 253        1     204804 vda1
 253        2   24959996 vda2
 253       16   16567296 vdb
 252        0    4194304 dm-0
 252        1    8392704 dm-1
 252        2    4194304 dm-2
 252        3    8175616 dm-3
 252        4   16564224 dm-4</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>View all available partitions using <a class="reference external" href="http://www.thegeekstuff.com/2011/09/parted-command-examples/">parted
command</a></li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>parted /dev/vda 'print'

Model: Virtio Block Device (virtblk)
Disk /dev/vda: 25.8GB
Sector size (logical/physical): 512B/512B
Partition Table: msdos

Number  Start   End     Size    Type     File system  Flags
 1      1049kB  211MB   210MB   primary  ext3         boot, type=83
 2      211MB   25.8GB  25.6GB  primary               lvm, type=8e</pre>
</div>
</div></blockquote>
<ul class="simple">
<li><a class="reference external" href="http://www.thegeekstuff.com/2010/09/linux-fdisk/">fdisk</a> also
works pretty well</li>
</ul>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">fdisk</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="logical-volume-manager-lvm">
<h3>Logical Volume Manager (LVM)<a class="headerlink" href="#logical-volume-manager-lvm" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Logical Volume Manager <strong>filesystem extension</strong></li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>pvcreate /dev/sdb1

  Physical volume "/dev/sdb1" successfully created</pre>
</div>
<div class="highlight-python"><pre>vgscan

  Reading all physical volumes.  This may take a while...
  Found volume group "systemVG" using metadata type lvm2</pre>
</div>
<div class="highlight-python"><pre>lvscan

  ACTIVE            '/dev/systemVG/LVvar_log' [4.00 GiB] inherit
  ACTIVE            '/dev/systemVG/LVdata' [64.00 GiB] inherit
  ACTIVE            '/dev/systemVG/LVRoot' [7.91 GiB] inherit</pre>
</div>
<div class="highlight-python"><pre>pvscan

  PV /dev/sda2   VG systemVG        lvm2 [75.91 GiB / 0    free]
  PV /dev/sdb1                      lvm2 [150.00 GiB]
  Total: 2 [225.91 GiB] / in use: 1 [75.91 GiB] / in no VG: 1 [150.00 GiB]</pre>
</div>
<div class="highlight-python"><pre>vgextend systemVG /dev/sdb1
  Volume group "systemVG" successfully extended</pre>
</div>
<div class="highlight-python"><pre>vgs

  VG       #PV #LV #SN Attr   VSize   VFree
  systemVG   2   3   0 wz--n- 225.90g 150.00g</pre>
</div>
<div class="highlight-python"><pre>lvextend  -L213G /dev/systemVG/LVdata

  Extending logical volume LVdata to 213.00 GiB
  Logical volume LVdata successfully resized</pre>
</div>
<div class="highlight-python"><pre>resize2fs /dev/systemVG/LVdata

resize2fs 1.42.4 (12-June-2012)
Filesystem at /dev/systemVG/LVdata is mounted on /data; on-line resizing required
old_desc_blocks = 4, new_desc_blocks = 14
Performing an on-line resize of /dev/systemVG/LVdata to 55836672 (4k) blocks.
The filesystem on /dev/systemVG/LVdata is now 55836672 blocks long.</pre>
</div>
</div></blockquote>
</div>
<div class="section" id="filesystems">
<h3>Filesystems<a class="headerlink" href="#filesystems" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Filesystem <strong>disk space usage</strong></li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>df -h

Filesystem                         Size  Used Avail Use% Mounted on
devtmpfs                           2.0G   32K  2.0G   1% /dev
tmpfs                              2.0G     0  2.0G   0% /dev/shm
tmpfs                              2.0G  201M  1.8G  11% /run
/dev/mapper/systemVG-LVRoot        7.5G  2.1G  5.0G  29% /
tmpfs                              2.0G     0  2.0G   0% /sys/fs/cgroup
tmpfs                              2.0G  201M  1.8G  11% /var/lock
tmpfs                              2.0G  201M  1.8G  11% /var/run
/dev/mapper/dataVG-LVdata           16G  179M   15G   2% /data
/dev/vda1                          199M   53M  136M  28% /boot
/dev/mapper/systemVG-LVvar_spool_  3.9G  143M  3.6G   4% /var/spool
/dev/mapper/systemVG-LVopt_        3.9G  330M  3.4G   9% /opt
/dev/mapper/systemVG-LVvar_log_    7.8G  200M  7.2G   3% /var/log</pre>
</div>
</div></blockquote>
<ul class="simple">
<li>List <strong>inode information</strong> instead of block usage</li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>df -ih

Filesystem                        Inodes IUsed IFree IUse% Mounted on
devtmpfs                            495K   416  494K    1% /dev
tmpfs                               496K     1  496K    1% /dev/shm
tmpfs                               496K   431  495K    1% /run
/dev/mapper/systemVG-LVRoot         1.6M   71K  1.5M    5% /
tmpfs                               496K    13  496K    1% /sys/fs/cgroup
tmpfs                               496K   431  495K    1% /var/lock
tmpfs                               496K   431  495K    1% /var/run
/dev/mapper/dataVG-LVdata          1013K   616 1012K    1% /data
/dev/vda1                            13K   564   12K    5% /boot
/dev/mapper/systemVG-LVvar_log_     1.1M  1.2K  1.0M    1% /var/log
/dev/mapper/systemVG-LVvar_spool_   512K    72  512K    1% /var/spool
/dev/mapper/systemVG-LVopt_         512K  9.7K  503K    2% /opt</pre>
</div>
</div></blockquote>
</div>
<div class="section" id="check-and-repair-filesystems">
<h3>Check and Repair Filesystems<a class="headerlink" href="#check-and-repair-filesystems" title="Permalink to this headline">¶</a></h3>
<p><strong>fsck</strong> (file system consistency check) utility is used to <strong>check and
repair filesystems</strong> (<a class="reference external" href="http://www.thegeekstuff.com/2011/05/ext2-ext3-ext4/">ext2, ext3, ext4,
...</a>). Depending
on the last time of filesystem checks, the operating system runs fsck
during boot time to check whether filesystems are in consistent states.</p>
<p>You could also <a class="reference external" href="http://www.thegeekstuff.com/2012/08/fsck-command-examples/">run fsck command
manually</a>
when there is a problem with filesystems. <strong>Make sure to execute the
fsck on an unmounted filesystems to avoid any data corruption issues.</strong></p>
<p><strong>Note</strong>: You need to be <strong>root</strong> and <strong>console access</strong> to use any of
the below mentioned commands.</p>
<ul class="simple">
<li>Take system down to <strong>runlevel one - no network access</strong></li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>init 1</pre>
</div>
</div></blockquote>
<ul class="simple">
<li><strong>Unmount</strong> filesystem</li>
</ul>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">umount</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">elasticsearch</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Check a specific filesystem and <strong>attempt to fix detected problems
automaticly</strong></li>
</ul>
<blockquote>
<div><div class="highlight-python"><pre>fsck -y /data

fsck from util-linux 2.21.2
e2fsck 1.42.6 (21-Sep-2012)
/dev/mapper/dataVG-LVdata: clean, 438/1036320 files, 110534/4141056 blocks</pre>
</div>
</div></blockquote>
<ul class="simple">
<li><strong>Automatically repair damaged portions</strong> using option -a</li>
</ul>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">fsck</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">AR</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Once fsck finished, <strong>remount</strong> filesystem</li>
</ul>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">mount</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">elasticsearch</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>If you want to <strong>force fsck on the next boot</strong>, just create a file
called /forcefsck</li>
</ul>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">touch</span> <span class="o">/</span><span class="n">forcefsck</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><strong>Reboot</strong> your system and when it comes up, fsck will be forced if
/forcefsck file is present</li>
</ul>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">reboot</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="five-ways-to-boot-opensuse-when-grub-is-broken">
<h3>Five ways to boot openSUSE when Grub is broken<a class="headerlink" href="#five-ways-to-boot-opensuse-when-grub-is-broken" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://swerdna.dyndns.org/susebootfive.html">HowTo Boot into
openSUSE</a> when it won&#8217;t
Boot from the Grub Code on the Hard Drive</p>
</div>
<div class="section" id="us-keyboard-layout">
<h3>US Keyboard Layout<a class="headerlink" href="#us-keyboard-layout" title="Permalink to this headline">¶</a></h3>
<p>Regardless of what language and keyboard layout your final installation
will be using, most BIOS configurations use the US keyboard layout as
depicted in the following figure:</p>
<p><img alt="image0" src="../_images/keyboard_us.png" /></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Operation Guide</a><ul>
<li><a class="reference internal" href="#basic-knowledge">Basic Knowledge</a></li>
<li><a class="reference internal" href="#secure-network-operations">Secure Network Operations</a><ul>
<li><a class="reference internal" href="#secure-shell">Secure Shell</a></li>
</ul>
</li>
<li><a class="reference internal" href="#event-and-trap-generation-for-specific-testing">Event and trap generation for specific testing</a><ul>
<li><a class="reference internal" href="#snmp-trap">SNMP trap</a></li>
<li><a class="reference internal" href="#syslog-event">Syslog event</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-operations">Basic operations</a><ul>
<li><a class="reference internal" href="#elma-reconfigure-and-restart">ELMA reconfigure and restart</a></li>
<li><a class="reference internal" href="#time-synchronization">Time synchronization</a></li>
<li><a class="reference internal" href="#delete-and-optimize-of-time-based-indices">Delete and optimize of time-based indices</a></li>
<li><a class="reference internal" href="#backup-of-system-configurations">Backup of system configurations</a></li>
<li><a class="reference internal" href="#systemd-system-and-service-manager">systemd system and service manager</a></li>
<li><a class="reference internal" href="#opensuse-firewall">openSUSE firewall</a></li>
<li><a class="reference internal" href="#process-table">Process table</a></li>
<li><a class="reference internal" href="#log-files">Log files</a></li>
<li><a class="reference internal" href="#storage-devices-and-disk-partitions">Storage devices and disk partitions</a></li>
<li><a class="reference internal" href="#logical-volume-manager-lvm">Logical Volume Manager (LVM)</a></li>
<li><a class="reference internal" href="#filesystems">Filesystems</a></li>
<li><a class="reference internal" href="#check-and-repair-filesystems">Check and Repair Filesystems</a></li>
<li><a class="reference internal" href="#five-ways-to-boot-opensuse-when-grub-is-broken">Five ways to boot openSUSE when Grub is broken</a></li>
<li><a class="reference internal" href="#us-keyboard-layout">US Keyboard Layout</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="administration.html"
                        title="previous chapter">Administration Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="user.html"
                        title="next chapter">User Guide</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/manuals/operation.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="user.html" title="User Guide"
             >next</a> |</li>
        <li class="right" >
          <a href="administration.html" title="Administration Guide"
             >previous</a> |</li>
        <li><a href="../index.html">ELMA 0.2.6 documentation</a> &raquo;</li>
          <li><a href="index.html" >Manuals</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Joerg Heinemann.
    </div>
  </body>
</html>